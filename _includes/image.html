{% capture imagePath %}{{ page.path | remove_first: "_posts/" | remove: ".md" }}/{{ include.name }}{% endcapture %}
{% if include.caption %}
<!-- courtesy: Eduardo Boucas https://eduardoboucas.com/blog/2014/12/07/including-and-managing-images-in-jekyll.html -->
<figure>
    <img src="/assets/posts/{{ imagePath }}" {% if include.alt %} alt="{{ include.alt }}" {% endif %} {% if include.width %} width="{{ include.width }}" {% endif %}/>
    <figcaption>{{ include.caption }}</figcaption>
</figure>
{% else %}
<img src="/assets/posts/{{ imagePath }}" {% if include.alt %} alt="{{ include.alt }}" {% endif %} {% if include.width %} width="{{ include.width }}" {% endif %}/>
{% endif %}
